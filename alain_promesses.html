<!DOCTYPE html>

<html>
    <head>
	<meta charset="utf-8">
    </head>
    <body>
	<div id="result">Promise.race</div>
	<input type="text" id="boisson" value="">
	<input type="button" value="Click" onclick="commandeVerre(document.getElementById('boisson').value)">
	<script>

	 const promise1 = new Promise((resolve, reject) =>	     
	     setTimeout(resolve, 5000, 'promise1 resolved'));
	 
	 const promise2 = new Promise((resolve, reject) =>	     
	     setTimeout(resolve, 1000, 'promise2 resolved'));
	 
	 /* (2) Promise.race retourne la promesse la plus rapide */
	 Promise.race([promise1, promise2]).then(value => {
	     document.getElementById('result').innerHTML = value;
	 });


	 /* ----------------------------------------------------- */


 	 const promise3 = new Promise((resolve, reject) =>
	     setTimeout(reject, 100, 'foo'));
	 const promises = [promise1, promise3, promise2];
	 
	 /* (4) Promise.allSettled indique si une promesse est fulfilled ou rejected 
	    Promise.allSettled(promises)
	    .then((results) => results.forEach((result) => console.log(result.status)));
	  */


	 /* ----------------------------------------------------- */
	 

	 const timeOut = t => {
	     return new Promise((resolve, reject) => {
		 setTimeout(() => {
		     resolve(`Completed in ${t} seconds`)
		 }, t)
	     })
	 }

	 /* (1) Promise.all retourne toutes les promesse rÃ©solues dans l'ordre d'appel */
	 Promise.all([timeOut(1000/1000), timeOut(2000/1000), promises])
		.then(result => console.log(result))

	 /* ----------------------------------------------------- */
	 /* (3) */
	 function commandeVerre(maBoisson){
	     console.log("commandeVerre input maBoisson",maBoisson);
	     return new Promise( 
		 function(resolve, reject) { 
		     setTimeout(function() { 
			 resolve(maBoisson);
		     }, 10000);
		 }
	     );
	 }
	 
	 function jeTrinque(boisson){
	     console.log("jeTrinque input boisson '",boisson,"'");
	     return new Promise( 
		 function(resolve, reject) { 
		     console.log("Je trinque avec du " + boisson);
		     resolve ('Je trinque avec '+boisson);
		 }
	     )}
	 
	 function jeBois(boisson){
	     console.log("je bois le " + boisson);
	 }
	 
	 commandeVerre(boisson)
	     .then(b => jeTrinque(b))
	     .then(jeBois)
	 
	</script>
	
    </body>

</html>

  
