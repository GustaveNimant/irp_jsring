<!DOCTYPE html>
<html>
    <meta charset="utf8"/>
    <body>
	<h3>Click the button to Get the General Keyword.</h3>
	<button onclick="getGeneral()">Get General</button>
	<p id="demo"></p>

	<script>
	 const str_a =[
	     "trac  $Author: michel Combes_5$bla",
	     "trec  $Date: 12/02/19$blabla",
	     "tric  $mutable: /.brings/system/truc/bin/kwextract.pl$bla",
	     "troc  $next: unknown$bla",
	     "tryc  $parents: QmUmeXP7TdYQGMnL7GddRUQRHyrYwkPvAHTDx7rFvaCCaN$bla",
	     "trwc  $previous: QmUmeXP7TdYQGMnL7GddRUQRHyrYwkPvAHTDx7rFvaCCaN$bla",
	     "trxc  $qm: z6t$bla",
	     "trzc  $Signature: n/a$bla",
	     "The $Source: /etc/other/myfiles/foo.txt,v$bla..",
	     "truc  $spot: 1550712774$bla",
	     "<!-- $tic: 1576163731$ -->",
	     "un texte  ",  
	     "                     ",
	     "1. load file with  reader.readAsText(file,'UTF-8')",
	     "2. recupere contenu de $Source",
	     "3. afficher dans Input Value",
	     "<!-- $tic: 1576163731$ -->"
	 ]

	 let str = str_a.join("\n");
	 console.log("mapOfString str ",str);

	 var dic = new Map();

	 function mapOfString(str) {

	     let rex = /\$(.+?)\$/g;

	     var res = str.match(rex);
	     console.log("mapOfString res ",res);

	     for (let i=0; i < res.length; i++) {
		 var mat = res[i];
		 var keyVal = mat.match(/\$(.+): (.+)\$/);
		 console.log("mapOfString keyVal ",keyVal);
		 var key = keyVal[1];
		 var value = keyVal[2];
		 dic.set (key, value);
	     }
	     return dic;
	 }
	 
	 function getGeneral() {
	     keywordMap = mapOfString(str);
	     for (var [key, value] of keywordMap) {
		 console.log("getGeneral : "+ key + " => " + value);
	     }
	 }
	 
	</script>

    </body>
</html>
