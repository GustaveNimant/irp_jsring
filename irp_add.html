<!DOCTYPE html>

<script>

 const webui = 'http://127.0.0.1:5001';
 const api_url = webui + '/api/v0/'

 var payload = {
     a : 1,
     b : 2
 }

 var myString = JSON.stringify(payload)
 console.log('myString '+myString);
 
 getAdd(myString);
 
 function getAdd(str) {
     console.log('getAdd input str '+str);
     var url = api_url + 'add'
     console.log('url '+url);
     return fetchTextPost(url, str)
	 .then( obj => { return Promise.resolve(obj) })
	 .catch(logError)
 }

 function callback(tag) {
     console.log('callback tag '+tag)
     const substi = buf => {
	 let e = document.getElementById(tag);
	 e.innerHTML = buf;
     };
     return substi
 }

 function fetchTextPost(url, str) {
     return fetch(url, {
	 headers: {
	     'Accept': 'application/json',
	     'Content-Type': 'application/json;charset=utf-8'
	 },
	 method: "POST",
	 body: str
     })
	 .then( res => {console.log(res)} )
	 .catch( res => {console.log(res)} )
 }

 function validate(resp) {
     if (resp.status >= 200 && resp.status < 300) {
	 return Promise.resolve(resp)
     }
     return Promise.reject(new Error(resp.statusText))
 }

 function logError(err) { console.log(err); }
</script>
