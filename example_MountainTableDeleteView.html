<!DOCTYPE html>
<!-- https://www.valentinog.com/blog/html-table/ -->
<html lang="en">
    <head>
	<meta charset="UTF-8">
	<title>Build a table</title>
    </head>
    <body>
	<table id="myTable">
	    <caption id="caption">
	    </caption>
	    <!-- here goes our data! -->
	</table>
	<input type="button" onclick="viewAllRows(document.getElementById('myTable'))" value="View all rows">
	<input type="button" onclick="deleteAllRows(document.getElementById('myTable'))" value="Delete all rows">
    </body>
    
    <script>
     let mountains = [
	 { name: "Monte Falco", height: 1658, place: "Parco Foreste Casentinesi" },
	 { name: "Monte Falterona", height: 1654, place: "Parco Foreste Casentinesi" },
	 { name: "Poggio Scali", height: 1520, place: "Parco Foreste Casentinesi" },
	 { name: "Pratomagno", height: 1592, place: "Parco Foreste Casentinesi" },
	 { name: "Monte Amiata", height: 1738, place: "Siena" }
     ];

     function generateCaption(thead, caption) {
	 let ele = document.getElementById("caption");
         ele.innerHTML = caption;
	 
	 console.log('generateCaption ele',ele);
	 console.log('generateCaption ele.attributes',ele.attributes);
	 ele.style.color = "blue";
	 ele.style.border = "2px solid blue";
     }
     
     function generateTableHead(table, data) {
	 let thead = table.createTHead();
	 generateCaption(thead, "The Mountains");
	 let row = thead.insertRow();
	 for (let key of data) {
	     let th = document.createElement("th");
	     let text = document.createTextNode(key);
	     th.appendChild(text);
	     row.appendChild(th);
	 }
     }
     
     let table = document.querySelector("table");
     console.log('table',table);
     let data = Object.keys(mountains[0]);
     console.log('data',data);
     
     function generateTable(table, data) {
	 for (let element of data) {
	     console.log('generateTable element',element);
	     let row = table.insertRow();
	     console.log('generateTable row',row);
	     for (key in element) {
		 console.log('generateTable key',key);
		 let cell = row.insertCell();
		 console.log('generateTable cell',cell);
		 let text = document.createTextNode(element[key]);
		 console.log('generateTable text',text);
		 cell.appendChild(text);
		 cell.style.border="2px solid green";
	     }
	 }
     }
     
     generateTable(table, mountains); // keep this order
     generateTableHead(table, data);

     function appendBodyElement (tag, id, value) {
	 let ele = document.createElement (tag);
	 ele.id = id;
	 ele.innerHTML = value;
	 document.body.appendChild (ele);
     }
     
     function deleteAllRows(table) {
	 console.log('deleteAllRows input table', table);
	 console.log('deleteAllRows table rows', table.rows.length); // 6

	 var r = 0;  // Be careful with deleteRow : rows.length is modified.
	 while (table.rows[r]) {
	     console.log('deleteAllRows Row r',r,table.rows[r].innerHTML);

	     let cellCount = table.getElementsByTagName('tr')[r].cells.length;
	     console.log('deleteAllRows cellCount', cellCount);
	     
	     for (c=0; c < cellCount; c++){
		 console.log('row #',r, ' td #',c);
		 var val_cel = table.getElementsByTagName('tr')[r].cells[c].innerHTML;
		 console.log('val_cel',val_cel);
		 let text = 'ROW #' + r;
		 text += ' - CELL #' + c;
		 text += ' - Value : <b>';
		 text += val_cel
		 text += '</b> deleted';
		 appendBodyElement('div', '', text) 
	     }
	     
	     table.deleteRow(r);
	 }
     }
     
     function viewAllRows(table) {
	 console.log('table elements', table);
	 console.log('table rows', table.rows.length); // 6
	 
	 for (let r=0; r < table.rows.length; r++) {
	     console.log('deleteAllRows Row r',r,table.rows[r].innerHTML);

	     let cellCount = table.getElementsByTagName('tr')[r].cells.length;
	     console.log('deleteAllRows cellCount', cellCount);
	     
	     for (c=0; c < cellCount; c++){
		 console.log('row #',r, ' td #',c);
		 var val_cel = table.getElementsByTagName('tr')[r].cells[c].innerHTML;
		 console.log('val_cel',val_cel);
		 
		 let text = 'ROW #' + r;
		 text += ' - CELL #' + c;
		 text += ' - Value : <b>';
		 text += val_cel
		 text += '</b>';
		 appendBodyElement('div', '', text) 
	     }
	 }
	 appendBodyElement('hr','','');	 
     }
     
    </script>
</html>
